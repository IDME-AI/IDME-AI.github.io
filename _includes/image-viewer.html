<!-- 引入 QRCode.js -->
<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>

<div id="button-container">
    <button id="share-button">分享</button>
    <button id="back-button" onclick="history.back()">返回</button>
</div>

<div id="viewer"></div>

<!-- 用于显示二维码 -->
<div id="qrcode-container" style="text-align:center; margin-top:20px;"></div>

<script>
    window.onload = function () {
        const params = new URLSearchParams(window.location.search);
        const src = params.get('src');
        const title = params.get('title');
        const desc = params.get('desc');

        const html = `<h2>${title || ''}</h2>
                  <img src="${src || ''}" />
                  <p>${desc || ''}</p>`;
        document.getElementById('viewer').innerHTML = html;

        document.getElementById('share-button').addEventListener('click', () => {
            const url = window.location.href;

            // 清空之前二维码
            const qrcodeContainer = document.getElementById('qrcode-container');
            qrcodeContainer.innerHTML = '';

            // 生成二维码
            new QRCode(qrcodeContainer, {
                text: url,
                width: 180,
                height: 180,
                colorDark: "#000000",
                colorLight: "#ffffff",
                correctLevel: QRCode.CorrectLevel.H
            });
        });
    };
</script>
